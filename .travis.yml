language: ruby
rvm: 2.0.0

branches:
  only:
  - master

# first step
before_install:
  # http://projectpoppycock.com/unit-testing-with-angularjs-grunt-karma-and-travisci/
  # http://stackoverflow.com/questions/19255976/how-to-make-travis-execute-angular-tests-on-chrome-please-set-env-variable-chr
  #- "export DISPLAY=:99.0"
  #- "sh -e /etc/init.d/xvfb start"
  - npm install -g grunt-cli
  - npm install grunt-karma grunt-contrib-watch

# second step
install:
  - npm install
  - bundle install

before_script:
  - grunt karma
  - git config --global user.name "Travis CI"
  - git remote set-url origin https://Maltretieren:${GH_TOKEN}@github.com/Maltretieren/maltretieren.github.com.git

#script: phantomjs /tests/helloworld.js

#http://stackoverflow.com/questions/24537778/what-is-the-proper-way-to-get-the-karma-test-coverage-path-into-travis-ci
after_script:
  - grunt coveralls

# this is for Travis to be able to commit to github
env:
  global:
    secure: e7qb+HWe8cE7z7LVFCHqvCPCFyHRSRIzKYmUZHLfbaHOxE8e6K17eqSPFRIaBRYtEgjlIrx0OZe8Yh5uXehR9IiGRU3A4BlbiUDt0UClfIkplxf2coUMkAzWTa9kMDcErOY7GGBcv66vqKYC+III8Q+cNvyLkJXCZaNUYPhrGuE=

notifications:
  webhooks:
     urls:
        - https://webhooks.gitter.im/e/3e1f0d56076552547591
     on_success: always
     on_failure: always
     on_start: false