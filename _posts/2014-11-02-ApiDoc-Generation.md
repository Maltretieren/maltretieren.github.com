---
layout: post
categories:
 - devdoc
tagline:
tags:
 - basic
published: true
frontpage: false
comments: false
---
# ApiDoc

The ApiDoc documents the Controllers and Services. This post documents the workflow used to create the documentation automatically from the comments in the JavaScript source files using [JSdoc](http://usejsdoc.org/){:target="_self"} and [smartercomments](http://smartcomments.github.io/){:target="_self"}. You can see the results on [the ApiDoc page](https://maltretieren.github.io/apidoc/2014/11/01/ApiDoc/){:target="_self"}

## Flow
In the JavaScript source files you need to annotate your functions with comments. You can see examples at the commenting section. The ApiDoc is generated by running the grunt task "jsdoc2md:withTemplate". This can be done locally or during continous integration.

## Commenting
Preparation of a Controllers namespace
{% highlight javascript linenos=table %}
/**
 * @namespace Controllers
 * @description  The controller must be responsible for binding model data to views using $scope, and control information flow. It does not contain logic to fetch the data or manipulating it.
 */
{% endhighlight %}

Annotating single controllers
{% highlight javascript linenos=table %}
/**
 * @namespace Controllers.CommentsCtrl
 * @memborOf Controllers
 * @description `Bundles` *functions* to receive and save comments
 */
 myApp.controller("ExampleCtrl",function ($scope) {
 ...
 }
 
{% endhighlight %}

# Smartcomments
I use smartcomments to prevent cluttering my code comments with `@param` annotations, but also to be sure that the documentation of atttributes passed into functions are always up to date. This is an optional task run by Travis during assembly and not pushed back into my repository.

So, during Travis build I run the smartcomments generation command defined in `.travis.yml`:
{% highlight ruby %}
before_script:
  # automatically generate comments
  - smartcomments -g --config ./tests/config/smartcomments.json
{% endhighlight %}

First you need to have a `./tests/config/smartcomments.json`configuration file
{% highlight javascript linenos=table %}
{
    "target_dir": ["app/js/"],
    "match_files": ["^((?!~).)*.(js)$"],
    "backup" : false,
    "private" : true,
    "favor_generated" : true,
    "tags": {
        "function":{
            "name":{},
            "desc":{"value":"Description"},
            "params":{}
        }
    }
}
{% endhighlight %}

Prevent smartcomments from generating doc for functions you don't want to be visible in the documentation. Annotate with `/** @private  */`

{% highlight javascript linenos=table %}
/** @private  */
var privateFunction = function() {
...
}
{% endhighlight %}